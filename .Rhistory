w1s <- as.numeric(weights4s$W1)
w2s <- as.numeric(weights4s$W2)
w3s <- as.numeric(weights4s$W3)
w4s <- as.numeric(weights4s$W4)
s1s <- sd(BTCs)
s2s <- sd(REITs)
s3s <- sd(LPPs)
s4s <- sd(ZLOTOs)
cor12s <- cor(BTCs, REITs)
cor13s <- cor(BTCs, LPPs)
cor14s <- cor(BTCs, ZLOTOs)
cor23s <- cor(REITs, LPPs)
cor24s <- cor(REITs, ZLOTOs)
cor34s <- cor(LPPs, ZLOTOs)
korelacje <- cor(portfolio4s)
kable(korelacje,format = "html", caption = "Korelacje" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
iportfolios <- mean(BTC)* w1s + mean(REIT)* w2s + mean(LPP)* w3s + mean(ZLOTO)* w4s
sdp <- (w1s^2 * s1s^2 + w2s^2 * s2s^2 + w3s^2 * s3s^2 + w4s^2 * s4s^2 + 2* s1s*s2s*w1s*w2s*cor12s
+ 2* s1s*s3s*w1s*w3s*cor13s + 2* s1s*s4s*w1s*w4s*cor14s + 2* s2s*s3s*w2s*w3s*cor23s + 2* s2s*s4s*w2s*w4s*cor24s + 2* s3s*s4s*w3s*w4s*cor34s)^0.5
rf <- 0.0
sharp <- (iportfolios-rf)/sdp
data <- as.data.frame(cbind(w1s, w2s, w3s, w4s, iportfolios, sdp, sharp))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(min.risk$w1s, min.risk$w2s, min.risk$w3s, min.risk$w4s))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.risk$w1s, min.risk$w2s, min.risk$w3s, min.risk$w4s))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.risks$w1s, min.risks$w2s, min.risks$w3s, min.risks$w4s))
iportfolios <- mean(BTCs)* w1s + mean(REITs)* w2s + mean(LPPs)* w3s + mean(ZLOTOs)* w4s
sdp <- (w1s^2 * s1s^2 + w2s^2 * s2s^2 + w3s^2 * s3s^2 + w4s^2 * s4s^2 + 2* s1s*s2s*w1s*w2s*cor12s
+ 2* s1s*s3s*w1s*w3s*cor13s + 2* s1s*s4s*w1s*w4s*cor14s + 2* s2s*s3s*w2s*w3s*cor23s + 2* s2s*s4s*w2s*w4s*cor24s + 2* s3s*s4s*w3s*w4s*cor34s)^0.5
rf <- 0.0
sharp <- (iportfolios-rf)/sdp
data <- as.data.frame(cbind(w1s, w2s, w3s, w4s, iportfolios, sdp, sharp))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.risks$w1s, min.risks$w2s, min.risks$w3s, min.risks$w4s))
min.risks <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.risks$w1s, min.risks$w2s, min.risks$w3s, min.risks$w4s))
min.risks <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.risks$w1s, min.risks$w2s, min.risks$w3s, min.risks$w4s))
min.riske <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.risks$w1s, min.risks$w2s, min.risks$w3s, min.risks$w4s))
min.riske <- subset(data, data$sdp== min(data$sdp))
mi.rs <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(min.riske$w1s, min.riske$w2s, min.riske$w3s, min.riske$w4s))
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(max.effectivness$w1s, max.effectivness$w2s, max.effectivness$w3s, max.effectivness$w4s))
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(max.effectivness$w1s, max.effectivness$w2s, max.effectivness$w3s, max.effectivness$w4s))
min.risks <- subset(data, data$sdp== min(data$sdp))
min.risks <- subset(data, data$sdp==min(data$sdp))
min.risks <- subset(data, data$sdp==min(data$sdp))
max.effectivness <- subset(data, data$sharp==max(data$sharp))
max.ip <- subset(data, data$iportfolio4s==max(data$iportfolio4s))
max.w1 <- subset(data, data$w1s==1 & data$w2s==0 & data$w3s==0 & data$w4s==0)
max.w2 <- subset(data, data$w1s==0 & data$w2s==1 & data$w3s==0 & data$w4s==0)
max.w3 <- subset(data, data$w1s==0 & data$w2s==0 & data$w3s==1 & data$w4s==0)
max.w4 <- subset(data, data$w1s==0 & data$w2s==0 & data$w3s==0 & data$w4s==1)
des <- c("Minimal risk portfolio", "Maximum efficiency portfolio", "Maximum rate of return portfolio", "Max weight one portfolio", "Max weight two portfolio", "Max weight three portfolio")
sciezka <- "/Users/czare/Desktop/IAprojekt/IEdane.csv"
ror <- read.csv(sciezka, sep = ";", dec = ",")
portfolio4s <- ror[c(1,2,3,4)]
BTCs <- portfolio4$BTC
REITs <- portfolio4$REIT
LPPs <- portfolio4$LPP
ZLOTOs <- portfolio4$ZLOTO
sciezka3 <- "/Users/czare/Desktop/IAprojekt/weights4invss.txt"
weights4s <- read.table(sciezka3, dec = ",", header = TRUE, quote = "\"", stringsAsFactors = FALSE)
w1s <- as.numeric(weights4s$W1)
w2s <- as.numeric(weights4s$W2)
w3s <- as.numeric(weights4s$W3)
w4s <- as.numeric(weights4s$W4)
s1s <- sd(BTCs)
s2s <- sd(REITs)
s3s <- sd(LPPs)
s4s <- sd(ZLOTOs)
cor12s <- cor(BTCs, REITs)
cor13s <- cor(BTCs, LPPs)
cor14s <- cor(BTCs, ZLOTOs)
cor23s <- cor(REITs, LPPs)
cor24s <- cor(REITs, ZLOTOs)
cor34s <- cor(LPPs, ZLOTOs)
korelacje <- cor(portfolio4s)
kable(korelacje,format = "html", caption = "Korelacje" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
iportfolios <- mean(BTCs)* w1s + mean(REITs)* w2s + mean(LPPs)* w3s + mean(ZLOTOs)* w4s
sdp <- (w1s^2 * s1s^2 + w2s^2 * s2s^2 + w3s^2 * s3s^2 + w4s^2 * s4s^2 + 2* s1s*s2s*w1s*w2s*cor12s
+ 2* s1s*s3s*w1s*w3s*cor13s + 2* s1s*s4s*w1s*w4s*cor14s + 2* s2s*s3s*w2s*w3s*cor23s + 2* s2s*s4s*w2s*w4s*cor24s + 2* s3s*s4s*w3s*w4s*cor34s)^0.5
rf <- 0.0
sharp <- (iportfolios-rf)/sdp
data <- as.data.frame(cbind(w1s, w2s, w3s, w4s, iportfolios, sdp, sharp))
min.risks <- subset(data, data$sdp==min(data$sdp))
max.effectivness <- subset(data, data$sharp==max(data$sharp))
max.ip <- subset(data, data$iportfolio4s==max(data$iportfolio4s))
max.w1 <- subset(data, data$w1s==1 & data$w2s==0 & data$w3s==0 & data$w4s==0)
max.w2 <- subset(data, data$w1s==0 & data$w2s==1 & data$w3s==0 & data$w4s==0)
max.w3 <- subset(data, data$w1s==0 & data$w2s==0 & data$w3s==1 & data$w4s==0)
max.w4 <- subset(data, data$w1s==0 & data$w2s==0 & data$w3s==0 & data$w4s==1)
des <- c("Minimal risk portfolio", "Maximum efficiency portfolio", "Maximum rate of return portfolio", "Max weight one portfolio", "Max weight two portfolio", "Max weight three portfolio")
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTCs","REITs", "LPPs", "ZŁOTOs") ,w = c(max.effectivness$w1s, max.effectivness$w2s, max.effectivness$w3s, max.effectivness$w4s))
sciezka <- "/Users/czare/Desktop/IAprojekt/IEdane.csv"
ror <- read.csv(sciezka, sep = ";", dec = ",")
portfolio4s <- ror[c(1,2,3,4)]
BTCs <- portfolio4$BTC
REITs <- portfolio4$REIT
LPPs <- portfolio4$LPP
ZLOTOs <- portfolio4$ZLOTO
sciezka3 <- "/Users/czare/Desktop/IAprojekt/weights4invss.txt"
weights4s <- read.table(sciezka3, dec = ",", header = TRUE, quote = "\"", stringsAsFactors = FALSE)
w1s <- as.numeric(weights4s$W1)
w2s <- as.numeric(weights4s$W2)
w3s <- as.numeric(weights4s$W3)
w4s <- as.numeric(weights4s$W4)
iportfolios <- mean(BTCs)* w1s + mean(REITs)* w2s + mean(LPPs)* w3s + mean(ZLOTOs)* w4s
sdp <- (w1s^2 * s1s^2 + w2s^2 * s2s^2 + w3s^2 * s3s^2 + w4s^2 * s4s^2 + 2* s1s*s2s*w1s*w2s*cor12s
+ 2* s1s*s3s*w1s*w3s*cor13s + 2* s1s*s4s*w1s*w4s*cor14s + 2* s2s*s3s*w2s*w3s*cor23s + 2* s2s*s4s*w2s*w4s*cor24s + 2* s3s*s4s*w3s*w4s*cor34s)^0.5
rf <- 0.0
sharp <- (iportfolios-rf)/sdp
data <- as.data.frame(cbind(w1s, w2s, w3s, w4s, iportfolios, sdp, sharp))
min.risks <- subset(data, data$sdp==min(data$sdp))
max.effectivnesss <- subset(data, data$sharp==max(data$sharp))
max.ip <- subset(data, data$iportfolio4s==max(data$iportfolio4s))
max.w1 <- subset(data, data$w1s==1 & data$w2s==0 & data$w3s==0 & data$w4s==0)
max.w2 <- subset(data, data$w1s==0 & data$w2s==1 & data$w3s==0 & data$w4s==0)
max.w3 <- subset(data, data$w1s==0 & data$w2s==0 & data$w3s==1 & data$w4s==0)
max.w4 <- subset(data, data$w1s==0 & data$w2s==0 & data$w3s==0 & data$w4s==1)
des <- c("Minimal risk portfolio", "Maximum efficiency portfolio", "Maximum rate of return portfolio", "Max weight one portfolio", "Max weight two portfolio", "Max weight three portfolio")
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(ggplot2)
library(tidyr)
library(kableExtra)
library(ggstatsplot)
library(gtsummary)
sciezka <- "/Users/czare/Desktop/IAprojekt/IEdane.csv"
ror <- read.csv(sciezka, sep = ";", dec = ",")
portfolio4 <- ror[c(1,2,3,4)]
BTC <- portfolio4$BTC
REIT <- portfolio4$REIT
LPP <- portfolio4$LPP
ZLOTO <- portfolio4$ZLOTO
sciezka2 <- "/Users/czare/Desktop/IAprojekt/weights4inv.txt"
weights4 <- read.table(sciezka2, dec = ",", header = TRUE, quote = "\"", stringsAsFactors = FALSE)
w1 <- as.numeric(weights4$W1)
w2 <- as.numeric(weights4$W2)
w3 <- as.numeric(weights4$W3)
w4 <- as.numeric(weights4$W4)
opisowe <- as.data.frame(summary(portfolio4))
opisowe <- data.frame(stat = c("MIN", "1 kwantyl", "Moda", "Średnia", "3 kwantyl", "MAX"), BTC = c("-0.097000", "-0.007000", "0.000000", "0.002108", "0.011000", "0.076000"), REIT = c("-0.065000", "-0.006000", "0.000000", "0.001014", "0.006000", "0.097000"), LPP = c("-0.055000", "-0.006000", "0.000000", "0.001371", "0.008000", "0.074000"), ZŁOTO = c("-0.0200000", "-0.0020000", "0.000000", "0.0002207", "0.0020000", "0.0310000"))
kable(opisowe,format = "html", caption = "Statystyki opisowe" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
s1 <- sd(BTC)
s2 <- sd(REIT)
s3 <- sd(LPP)
s4 <- sd(ZLOTO)
cor12 <- cor(BTC, REIT)
cor13 <- cor(BTC, LPP)
cor14 <- cor(BTC, ZLOTO)
cor23 <- cor(REIT, LPP)
cor24 <- cor(REIT, ZLOTO)
cor34 <- cor(LPP, ZLOTO)
korelacje <- cor(portfolio4)
kable(korelacje,format = "html", caption = "Korelacje" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
iportfolio <- mean(BTC)* w1 + mean(REIT)* w2 + mean(LPP)* w3 + mean(ZLOTO)* w4
sdp <- (w1^2 * s1^2 + w2^2 * s2^2 + w3^2 * s3^2 + w4^2 * s4^2 + 2* s1*s2*w1*w2*cor12
+ 2* s1*s3*w1*w3*cor13 + 2* s1*s4*w1*w4*cor14 + 2* s2*s3*w2*w3*cor23 + 2* s2*s4*w2*w4*cor24 + 2* s3*s4*w3*w4*cor34)^0.5
rf <- 0.0
sharp <- (iportfolio-rf)/sdp
data <- as.data.frame(cbind(w1, w2, w3, w4, iportfolio, sdp, sharp))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.r <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(min.risk$w1, min.risk$w2, min.risk$w3, min.risk$w4))
ggplot(mi.r, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o minimalnym ryzyku")
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(max.effectivness$w1, max.effectivness$w2, max.effectivness$w3, max.effectivness$w4))
ggplot(mx.e, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o maksymalnej efektywności")
max.ip <- subset(data, data$iportfolio==max(data$iportfolio))
max.w1 <- subset(data, data$w1==1)
max.w2 <- subset(data, data$w2==1)
max.w3 <- subset(data, data$w3==1)
max.w4 <- subset(data, data$w4==1)
des <- c("Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Portfel z najwyższą stopą zwrotu", "Najwyższy udział BTC", "Najwyższy udział REIT", "Najwyższy udział LPP", "Najwyższy udział złota")
results <- cbind(rbind(min.risk, max.effectivness, max.ip, max.w1, max.w2, max.w3, max.w4), des)
kable(results,format = "html", caption = "Interesujące kombinacje portfela" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
plot(sdp, iportfolio, type= "p", col = "grey")
title(main="Zbiór możliwości inwestycyjnych")
points(min.risk$sdp, min.risk$iportfolio, pch=19, col="green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch=19, col="blue")
points(max.w1$sdp, max.w1$iportfolio, pch=19, col="black")
points(max.w2$sdp, max.w2$iportfolio, pch=19, col="black")
points(max.w3$sdp, max.w3$iportfolio, pch=19, col="black")
points(max.w4$sdp, max.w4$iportfolio, pch=19, col="black")
legend(legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności",
"Jednoelementowe portfele"),
pch = c(19, 19, 19, 19, 19, 4),
col = c("red", "green", "blue", "black"),
"topleft", bty = "n", cex = 0.7)
dev.copy(png, filename="plot.png")
dev.off ()
plot(sdp, iportfolio, type = "p", col = "grey", main = "Zbiór możliwości inwestycyjnych", xlim = c(-0.003, max(sdp)), ylim = c(0, max(iportfolio)))
points(min.risk$sdp, min.risk$iportfolio, pch = 19, col = "green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch = 19, col = "blue")
points(max.w1$sdp, max.w1$iportfolio, pch = 19, col = "black")
points(max.w2$sdp, max.w2$iportfolio, pch = 19, col = "black")
points(max.w3$sdp, max.w3$iportfolio, pch = 19, col = "black")
points(max.w4$sdp, max.w4$iportfolio, pch = 19, col = "black")
abline(a = 0, b = (max.effectivness$iportfolio - 0) / (max.effectivness$sdp - 0), col = "red", lty = 2)  # CML
text(0, max.effectivness$iportfolio, "CML", pos = 2, col = "red")  # Etykieta CML
abline(a = 0, b = (min.risk$iportfolio - 0) / (min.risk$sdp - 0), col = "green", lty = 2)  # MR
text(0, min.risk$iportfolio, "MR", pos = 2, col = "green")  # Etykieta MR
legend("topleft",
legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Jednoelementowe portfele"),
pch = c(19, 19, 19, 19),
col = c("green", "blue", "black", "black"),
bty = "n", cex = 0.7)
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(ggplot2)
library(tidyr)
library(kableExtra)
library(ggstatsplot)
library(gtsummary)
sciezka <- "/Users/czare/Desktop/IAprojekt/IEdane.csv"
ror <- read.csv(sciezka, sep = ";", dec = ",")
portfolio4 <- ror[c(1,2,3,4)]
BTC <- portfolio4$BTC
REIT <- portfolio4$REIT
LPP <- portfolio4$LPP
ZLOTO <- portfolio4$ZLOTO
sciezka2 <- "/Users/czare/Desktop/IAprojekt/weights4inv.txt"
weights4 <- read.table(sciezka2, dec = ",", header = TRUE, quote = "\"", stringsAsFactors = FALSE)
w1 <- as.numeric(weights4$W1)
w2 <- as.numeric(weights4$W2)
w3 <- as.numeric(weights4$W3)
w4 <- as.numeric(weights4$W4)
opisowe <- as.data.frame(summary(portfolio4))
opisowe <- data.frame(stat = c("MIN", "1 kwantyl", "Moda", "Średnia", "3 kwantyl", "MAX"), BTC = c("-0.097000", "-0.007000", "0.000000", "0.002108", "0.011000", "0.076000"), REIT = c("-0.065000", "-0.006000", "0.000000", "0.001014", "0.006000", "0.097000"), LPP = c("-0.055000", "-0.006000", "0.000000", "0.001371", "0.008000", "0.074000"), ZŁOTO = c("-0.0200000", "-0.0020000", "0.000000", "0.0002207", "0.0020000", "0.0310000"))
kable(opisowe,format = "html", caption = "Statystyki opisowe" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
s1 <- sd(BTC)
s2 <- sd(REIT)
s3 <- sd(LPP)
s4 <- sd(ZLOTO)
cor12 <- cor(BTC, REIT)
cor13 <- cor(BTC, LPP)
cor14 <- cor(BTC, ZLOTO)
cor23 <- cor(REIT, LPP)
cor24 <- cor(REIT, ZLOTO)
cor34 <- cor(LPP, ZLOTO)
korelacje <- cor(portfolio4)
kable(korelacje,format = "html", caption = "Korelacje" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
iportfolio <- mean(BTC)* w1 + mean(REIT)* w2 + mean(LPP)* w3 + mean(ZLOTO)* w4
sdp <- (w1^2 * s1^2 + w2^2 * s2^2 + w3^2 * s3^2 + w4^2 * s4^2 + 2* s1*s2*w1*w2*cor12
+ 2* s1*s3*w1*w3*cor13 + 2* s1*s4*w1*w4*cor14 + 2* s2*s3*w2*w3*cor23 + 2* s2*s4*w2*w4*cor24 + 2* s3*s4*w3*w4*cor34)^0.5
rf <- 0.0
sharp <- (iportfolio-rf)/sdp
data <- as.data.frame(cbind(w1, w2, w3, w4, iportfolio, sdp, sharp))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.r <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(min.risk$w1, min.risk$w2, min.risk$w3, min.risk$w4))
ggplot(mi.r, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o minimalnym ryzyku")
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(max.effectivness$w1, max.effectivness$w2, max.effectivness$w3, max.effectivness$w4))
ggplot(mx.e, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o maksymalnej efektywności")
max.ip <- subset(data, data$iportfolio==max(data$iportfolio))
max.w1 <- subset(data, data$w1==1)
max.w2 <- subset(data, data$w2==1)
max.w3 <- subset(data, data$w3==1)
max.w4 <- subset(data, data$w4==1)
des <- c("Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Portfel z najwyższą stopą zwrotu", "Najwyższy udział BTC", "Najwyższy udział REIT", "Najwyższy udział LPP", "Najwyższy udział złota")
results <- cbind(rbind(min.risk, max.effectivness, max.ip, max.w1, max.w2, max.w3, max.w4), des)
kable(results,format = "html", caption = "Interesujące kombinacje portfela" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
plot(sdp, iportfolio, type= "p", col = "grey")
title(main="Zbiór możliwości inwestycyjnych")
points(min.risk$sdp, min.risk$iportfolio, pch=19, col="green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch=19, col="blue")
points(max.w1$sdp, max.w1$iportfolio, pch=19, col="black")
points(max.w2$sdp, max.w2$iportfolio, pch=19, col="black")
points(max.w3$sdp, max.w3$iportfolio, pch=19, col="black")
points(max.w4$sdp, max.w4$iportfolio, pch=19, col="black")
legend(legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności",
"Jednoelementowe portfele"),
pch = c(19, 19, 19, 19, 19, 4),
col = c("red", "green", "blue", "black"),
"topleft", bty = "n", cex = 0.7)
dev.copy(png, filename="plot.png")
dev.off ()
plot(sdp, iportfolio, type = "p", col = "grey", main = "Zbiór możliwości inwestycyjnych", xlim = c(-0.003, max(sdp)), ylim = c(0, max(iportfolio)))
points(min.risk$sdp, min.risk$iportfolio, pch = 19, col = "green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch = 19, col = "blue")
points(max.w1$sdp, max.w1$iportfolio, pch = 19, col = "black")
points(max.w2$sdp, max.w2$iportfolio, pch = 19, col = "black")
points(max.w3$sdp, max.w3$iportfolio, pch = 19, col = "black")
points(max.w4$sdp, max.w4$iportfolio, pch = 19, col = "black")
abline(a = 0, b = (max.effectivness$iportfolio - 0) / (max.effectivness$sdp - 0), col = "red", lty = 2)  # CML
text(0, max.effectivness$iportfolio, "CML", pos = 2, col = "red")  # Etykieta CML
abline(a = 0, b = (min.risk$iportfolio - 0) / (min.risk$sdp - 0), col = "green", lty = 2)  # MR
text(0, min.risk$iportfolio, "MR", pos = 2, col = "green")  # Etykieta MR
legend("topleft",
legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Jednoelementowe portfele"),
pch = c(19, 19, 19, 19),
col = c("green", "blue", "black", "black"),
bty = "n", cex = 0.7)
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(ggplot2)
library(tidyr)
library(kableExtra)
library(ggstatsplot)
library(gtsummary)
sciezka <- "/Users/czare/Desktop/IAprojekt/IEdane.csv"
ror <- read.csv(sciezka, sep = ";", dec = ",")
portfolio4 <- ror[c(1,2,3,4)]
BTC <- portfolio4$BTC
REIT <- portfolio4$REIT
LPP <- portfolio4$LPP
ZLOTO <- portfolio4$ZLOTO
sciezka2 <- "/Users/czare/Desktop/IAprojekt/weights4inv.txt"
weights4 <- read.table(sciezka2, dec = ",", header = TRUE, quote = "\"", stringsAsFactors = FALSE)
w1 <- as.numeric(weights4$W1)
w2 <- as.numeric(weights4$W2)
w3 <- as.numeric(weights4$W3)
w4 <- as.numeric(weights4$W4)
opisowe <- as.data.frame(summary(portfolio4))
opisowe <- data.frame(stat = c("MIN", "1 kwantyl", "Moda", "Średnia", "3 kwantyl", "MAX"), BTC = c("-0.097000", "-0.007000", "0.000000", "0.002108", "0.011000", "0.076000"), REIT = c("-0.065000", "-0.006000", "0.000000", "0.001014", "0.006000", "0.097000"), LPP = c("-0.055000", "-0.006000", "0.000000", "0.001371", "0.008000", "0.074000"), ZŁOTO = c("-0.0200000", "-0.0020000", "0.000000", "0.0002207", "0.0020000", "0.0310000"))
kable(opisowe,format = "html", caption = "Statystyki opisowe" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
s1 <- sd(BTC)
s2 <- sd(REIT)
s3 <- sd(LPP)
s4 <- sd(ZLOTO)
cor12 <- cor(BTC, REIT)
cor13 <- cor(BTC, LPP)
cor14 <- cor(BTC, ZLOTO)
cor23 <- cor(REIT, LPP)
cor24 <- cor(REIT, ZLOTO)
cor34 <- cor(LPP, ZLOTO)
korelacje <- cor(portfolio4)
kable(korelacje,format = "html", caption = "Korelacje" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
iportfolio <- mean(BTC)* w1 + mean(REIT)* w2 + mean(LPP)* w3 + mean(ZLOTO)* w4
sdp <- (w1^2 * s1^2 + w2^2 * s2^2 + w3^2 * s3^2 + w4^2 * s4^2 + 2* s1*s2*w1*w2*cor12
+ 2* s1*s3*w1*w3*cor13 + 2* s1*s4*w1*w4*cor14 + 2* s2*s3*w2*w3*cor23 + 2* s2*s4*w2*w4*cor24 + 2* s3*s4*w3*w4*cor34)^0.5
rf <- 0.0
sharp <- (iportfolio-rf)/sdp
data <- as.data.frame(cbind(w1, w2, w3, w4, iportfolio, sdp, sharp))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.r <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(min.risk$w1, min.risk$w2, min.risk$w3, min.risk$w4))
ggplot(mi.r, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o minimalnym ryzyku")
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(max.effectivness$w1, max.effectivness$w2, max.effectivness$w3, max.effectivness$w4))
ggplot(mx.e, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o maksymalnej efektywności")
max.ip <- subset(data, data$iportfolio==max(data$iportfolio))
max.w1 <- subset(data, data$w1==1)
max.w2 <- subset(data, data$w2==1)
max.w3 <- subset(data, data$w3==1)
max.w4 <- subset(data, data$w4==1)
des <- c("Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Portfel z najwyższą stopą zwrotu", "Najwyższy udział BTC", "Najwyższy udział REIT", "Najwyższy udział LPP", "Najwyższy udział złota")
results <- cbind(rbind(min.risk, max.effectivness, max.ip, max.w1, max.w2, max.w3, max.w4), des)
kable(results,format = "html", caption = "Interesujące kombinacje portfela" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
plot(sdp, iportfolio, type= "p", col = "grey")
title(main="Zbiór możliwości inwestycyjnych")
points(min.risk$sdp, min.risk$iportfolio, pch=19, col="green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch=19, col="blue")
points(max.w1$sdp, max.w1$iportfolio, pch=19, col="black")
points(max.w2$sdp, max.w2$iportfolio, pch=19, col="black")
points(max.w3$sdp, max.w3$iportfolio, pch=19, col="black")
points(max.w4$sdp, max.w4$iportfolio, pch=19, col="black")
legend(legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności",
"Jednoelementowe portfele"),
pch = c(19, 19, 19, 19, 19, 4),
col = c("red", "green", "blue", "black"),
"topleft", bty = "n", cex = 0.7)
plot(sdp, iportfolio, type = "p", col = "grey", main = "Zbiór możliwości inwestycyjnych", xlim = c(-0.003, max(sdp)), ylim = c(0, max(iportfolio)))
points(min.risk$sdp, min.risk$iportfolio, pch = 19, col = "green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch = 19, col = "blue")
points(max.w1$sdp, max.w1$iportfolio, pch = 19, col = "black")
points(max.w2$sdp, max.w2$iportfolio, pch = 19, col = "black")
points(max.w3$sdp, max.w3$iportfolio, pch = 19, col = "black")
points(max.w4$sdp, max.w4$iportfolio, pch = 19, col = "black")
abline(a = 0, b = (max.effectivness$iportfolio - 0) / (max.effectivness$sdp - 0), col = "red", lty = 2)  # CML
text(0, max.effectivness$iportfolio, "CML", pos = 2, col = "red")  # Etykieta CML
abline(a = 0, b = (min.risk$iportfolio - 0) / (min.risk$sdp - 0), col = "green", lty = 2)  # MR
text(0, min.risk$iportfolio, "MR", pos = 2, col = "green")  # Etykieta MR
legend("topleft",
legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Jednoelementowe portfele"),
pch = c(19, 19, 19, 19),
col = c("green", "blue", "black", "black"),
bty = "n", cex = 0.7)
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(ggplot2)
library(tidyr)
library(kableExtra)
library(ggstatsplot)
library(gtsummary)
sciezka <- "/Users/czare/Desktop/IAprojekt/IEdane.csv"
ror <- read.csv(sciezka, sep = ";", dec = ",")
portfolio4 <- ror[c(1,2,3,4)]
BTC <- portfolio4$BTC
REIT <- portfolio4$REIT
LPP <- portfolio4$LPP
ZLOTO <- portfolio4$ZLOTO
sciezka2 <- "/Users/czare/Desktop/IAprojekt/weights4inv.txt"
weights4 <- read.table(sciezka2, dec = ",", header = TRUE, quote = "\"", stringsAsFactors = FALSE)
w1 <- as.numeric(weights4$W1)
w2 <- as.numeric(weights4$W2)
w3 <- as.numeric(weights4$W3)
w4 <- as.numeric(weights4$W4)
opisowe <- as.data.frame(summary(portfolio4))
opisowe <- data.frame(stat = c("MIN", "1 kwantyl", "Moda", "Średnia", "3 kwantyl", "MAX"), BTC = c("-0.097000", "-0.007000", "0.000000", "0.002108", "0.011000", "0.076000"), REIT = c("-0.065000", "-0.006000", "0.000000", "0.001014", "0.006000", "0.097000"), LPP = c("-0.055000", "-0.006000", "0.000000", "0.001371", "0.008000", "0.074000"), ZŁOTO = c("-0.0200000", "-0.0020000", "0.000000", "0.0002207", "0.0020000", "0.0310000"))
kable(opisowe,format = "html", caption = "Statystyki opisowe" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
s1 <- sd(BTC)
s2 <- sd(REIT)
s3 <- sd(LPP)
s4 <- sd(ZLOTO)
cor12 <- cor(BTC, REIT)
cor13 <- cor(BTC, LPP)
cor14 <- cor(BTC, ZLOTO)
cor23 <- cor(REIT, LPP)
cor24 <- cor(REIT, ZLOTO)
cor34 <- cor(LPP, ZLOTO)
korelacje <- cor(portfolio4)
kable(korelacje,format = "html", caption = "Korelacje" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
iportfolio <- mean(BTC)* w1 + mean(REIT)* w2 + mean(LPP)* w3 + mean(ZLOTO)* w4
sdp <- (w1^2 * s1^2 + w2^2 * s2^2 + w3^2 * s3^2 + w4^2 * s4^2 + 2* s1*s2*w1*w2*cor12
+ 2* s1*s3*w1*w3*cor13 + 2* s1*s4*w1*w4*cor14 + 2* s2*s3*w2*w3*cor23 + 2* s2*s4*w2*w4*cor24 + 2* s3*s4*w3*w4*cor34)^0.5
rf <- 0.0
sharp <- (iportfolio-rf)/sdp
data <- as.data.frame(cbind(w1, w2, w3, w4, iportfolio, sdp, sharp))
min.risk <- subset(data, data$sdp== min(data$sdp))
mi.r <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(min.risk$w1, min.risk$w2, min.risk$w3, min.risk$w4))
ggplot(mi.r, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o minimalnym ryzyku")
max.effectivness <- subset(data, data$sharp== max(data$sharp))
mx.e <- data.frame(num = c("BTC","REIT", "LPP", "ZŁOTO") ,w = c(max.effectivness$w1, max.effectivness$w2, max.effectivness$w3, max.effectivness$w4))
ggplot(mx.e, aes(x = "", y = w, fill = num)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
theme_minimal() +
scale_fill_brewer(palette = "Set3") + labs(fill = "Składniki portfela") + ggtitle("Portfel o maksymalnej efektywności")
max.ip <- subset(data, data$iportfolio==max(data$iportfolio))
max.w1 <- subset(data, data$w1==1)
max.w2 <- subset(data, data$w2==1)
max.w3 <- subset(data, data$w3==1)
max.w4 <- subset(data, data$w4==1)
des <- c("Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Portfel z najwyższą stopą zwrotu", "Najwyższy udział BTC", "Najwyższy udział REIT", "Najwyższy udział LPP", "Najwyższy udział złota")
results <- cbind(rbind(min.risk, max.effectivness, max.ip, max.w1, max.w2, max.w3, max.w4), des)
kable(results,format = "html", caption = "Interesujące kombinacje portfela" ) %>%
kable_styling("striped", "hover", "condensed", full_width = F, position = "left")
plot(sdp, iportfolio, type= "p", col = "grey")
title(main="Zbiór możliwości inwestycyjnych")
points(min.risk$sdp, min.risk$iportfolio, pch=19, col="green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch=19, col="blue")
points(max.w1$sdp, max.w1$iportfolio, pch=19, col="black")
points(max.w2$sdp, max.w2$iportfolio, pch=19, col="black")
points(max.w3$sdp, max.w3$iportfolio, pch=19, col="black")
points(max.w4$sdp, max.w4$iportfolio, pch=19, col="black")
legend(legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności",
"Jednoelementowe portfele"),
pch = c(19, 19, 19, 19, 19, 4),
col = c("red", "green", "blue", "black"),
"topleft", bty = "n", cex = 0.7)
plot(sdp, iportfolio, type = "p", col = "grey", main = "Zbiór możliwości inwestycyjnych", xlim = c(-0.003, max(sdp)), ylim = c(0, max(iportfolio)))
points(min.risk$sdp, min.risk$iportfolio, pch = 19, col = "green")
points(max.effectivness$sdp, max.effectivness$iportfolio, pch = 19, col = "blue")
points(max.w1$sdp, max.w1$iportfolio, pch = 19, col = "black")
points(max.w2$sdp, max.w2$iportfolio, pch = 19, col = "black")
points(max.w3$sdp, max.w3$iportfolio, pch = 19, col = "black")
points(max.w4$sdp, max.w4$iportfolio, pch = 19, col = "black")
abline(a = 0, b = (max.effectivness$iportfolio - 0) / (max.effectivness$sdp - 0), col = "red", lty = 2)  # CML
text(0, max.effectivness$iportfolio, "CML", pos = 2, col = "red")  # Etykieta CML
abline(a = 0, b = (min.risk$iportfolio - 0) / (min.risk$sdp - 0), col = "green", lty = 2)  # MR
text(0, min.risk$iportfolio, "MR", pos = 2, col = "green")  # Etykieta MR
legend("topleft",
legend = c("Zbiór możliwości inwestycyjnych", "Portfel o minimalnym ryzyku", "Portfel o maksymalnej efektywności", "Jednoelementowe portfele"),
pch = c(19, 19, 19, 19),
col = c("green", "blue", "black", "black"),
bty = "n", cex = 0.7)
